# Permissions Required
# API [deploymentmanager.googleapis.com]
# Identity and Access Management (IAM) API
# Compute API


imports:
  # IAM Roles
  - path: ./../../py_templates/cloud_iam/roles/custom_compute_role.py
    name: custom_compute_role.py
  - path: ./../../py_templates/cloud_iam/roles/custom_storage_role.py
    name: custom_storage_role.py
  # IAM Service Accounts
  - path: ./../../py_templates/cloud_iam/service_accounts/compute_service_account.py
    name: compute_service_account.py
  - path: ./../../py_templates/cloud_iam/service_accounts/instance_service_account.py
    name: instance_service_account.py
  - path: ./../../py_templates/cloud_iam/service_accounts/cloud_sql_proxy_service_account.py
    name: cloud_sql_proxy_service_account.py
  # IAM Bindings
  - path: ./../../py_templates/cloud_iam/iam_bindings/auth_csa_isa_on_isa.py
    name: auth_csa_isa_on_isa.py
  - path: ./../../py_templates/cloud_iam/iam_bindings/auth_qsa_on_csa.py
    name: auth_qsa_on_csa.py
  - path: ./../../py_templates/cloud_iam/iam_bindings/bind_compute_role_to_svc_accounts.py
    name: bind_compute_role_to_svc_accounts.py
  - path: ./../../py_templates/cloud_iam/iam_bindings/bind_storage_role_to_svc_accounts.py
    name: bind_storage_role_to_svc_accounts.py
  - path: ./../../py_templates/cloud_iam/iam_bindings/auth_cloud_proxy_svc_account.py
    name: auth_cloud_proxy_svc_account.py
  - path: ./../../py_templates/cloud_iam/iam_bindings/auth_svc_accounts_on_big_query.py
    name: auth_svc_accounts_on_big_query.py
  # Cloud Storage
  - path: ./../../py_templates/cloud_storage/qubole_defloc/qubole_defloc.py
    name: qubole_defloc.py

resources:
  # IAM Roles
  - name: qu_custom_storage_role
    type: custom_storage_role.py
    properties:
      project: qubole-on-gcp
      roleId: qubole_custom_storage_role_acc422_9
      title: qubole_custom_storage_role
      description: qubole_custom_storage_role
  - name: qu_custom_compute_role
    type: custom_compute_role.py
    properties:
      project: qubole-on-gcp
      roleId: qubole_custom_compute_role_acc422_9
      title: qubole_custom_compute_role
      description: qubole_custom_compute_role
  # IAM Service Accounts
  - name: qu_compute_service_account
    type: compute_service_account.py
    properties:
      project: qubole-on-gcp
      accountId: qubole-compute-service-acc
      displayName: qubole-compute-service-acc
      qubole-service-account: qbol-422-gcp@prod-qsa-project-1.iam.gserviceaccount.com
  - name: qu_instance_service_account
    type: instance_service_account.py
    properties:
      project: qubole-on-gcp
      accountId: qubole-instance-service-acc
      displayName: qubole-instance-service-acc
  - name: cloud_sql_proxy_service_account
    type: cloud_sql_proxy_service_account.py
  # IAM Bindings
  - name: auth_csa_isa_on_isa
    type: auth_csa_isa_on_isa.py
  - name: auth_qsa_on_csa
    type: auth_qsa_on_csa.py
    properties:
      qubole-service-account: qbol-422-gcp@prod-qsa-project-1.iam.gserviceaccount.com
  - name: bind_compute_role_to_svc_accounts
    type: bind_compute_role_to_svc_accounts.py
  - name: bind_storage_role_to_svc_accounts
    type: bind_storage_role_to_svc_accounts.py
  - name: auth_cloud_proxy_svc_account
    type: auth_cloud_proxy_svc_account.py
  - name: auth_svc_accounts_on_big_query
    type: auth_svc_accounts_on_big_query.py
  # Cloud Storage
  - name: qubole_default_location
    type: qubole_defloc.py
    properties:
      project: qubole-on-gcp
      org: vg-acc422-9